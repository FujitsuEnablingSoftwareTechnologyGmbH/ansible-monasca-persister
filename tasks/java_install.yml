---
- name: create jar_dir
  file: path={{monasca_jar_dir}} state=directory owner=root group=root mode=755

- name: Fetch persister jar
  get_url: dest={{monasca_jar_dir}}/monasca-persister.jar url="{{persister_tarball_base_url}}/monasca-persister-{{persister_version}}-shaded.jar" force=yes timeout=30
  register: get_url_result
  until: "'OK' in get_url_result.msg"
  retries: 5
  delay: 1
  notify:
    - restart monasca-persister
